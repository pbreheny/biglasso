<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extending Lasso Model Fitting to Big Data — biglasso-package • biglasso</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Extending Lasso Model Fitting to Big Data — biglasso-package"><meta name="description" content="Extend lasso and elastic-net linear, logistic and cox regression models for
ultrahigh-dimensional, multi-gigabyte data sets that cannot be loaded into
available RAM. This package utilizes memory-mapped files to store the
massive data on the disk and only read those into memory whenever necessary
during model fitting. Moreover, some advanced feature screening rules are
proposed and implemented to accelerate the model fitting. As a result, this
package is much more memory- and computation-efficient and highly scalable
as compared to existing lasso-fitting packages such as
glmnet and
ncvreg, thus allowing for
powerful big data analysis even with only an ordinary laptop."><meta property="og:description" content="Extend lasso and elastic-net linear, logistic and cox regression models for
ultrahigh-dimensional, multi-gigabyte data sets that cannot be loaded into
available RAM. This package utilizes memory-mapped files to store the
massive data on the disk and only read those into memory whenever necessary
during model fitting. Moreover, some advanced feature screening rules are
proposed and implemented to accelerate the model fitting. As a result, this
package is much more memory- and computation-efficient and highly scalable
as compared to existing lasso-fitting packages such as
glmnet and
ncvreg, thus allowing for
powerful big data analysis even with only an ordinary laptop."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biglasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/biglasso.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/biglasso/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extending Lasso Model Fitting to Big Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/biglasso/blob/master/R/biglasso-package.R" class="external-link"><code>R/biglasso-package.R</code></a></small>
      <div class="d-none name"><code>biglasso-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extend lasso and elastic-net linear, logistic and cox regression models for
ultrahigh-dimensional, multi-gigabyte data sets that cannot be loaded into
available RAM. This package utilizes memory-mapped files to store the
massive data on the disk and only read those into memory whenever necessary
during model fitting. Moreover, some advanced feature screening rules are
proposed and implemented to accelerate the model fitting. As a result, this
package is much more memory- and computation-efficient and highly scalable
as compared to existing lasso-fitting packages such as
<a href="https://CRAN.R-project.org/package=glmnet" class="external-link">glmnet</a> and
<a href="https://CRAN.R-project.org/package=ncvreg" class="external-link">ncvreg</a>, thus allowing for
powerful big data analysis even with only an ordinary laptop.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<table class="table table"><tr><td>Package:</td><td>biglasso</td></tr><tr><td>Type:</td><td>Package</td></tr><tr><td>Version:</td><td>1.4-1</td></tr><tr><td>Date:</td><td>2021-01-29</td></tr><tr><td>License:</td><td>GPL-3</td></tr></table><p>Penalized regression models, in particular the lasso, have been extensively
applied to analyzing high-dimensional data sets. However, due to the memory
limit, existing R packages are not capable of fitting lasso models for
ultrahigh-dimensional, multi-gigabyte data sets which have been increasingly
seen in many areas such as genetics, biomedical imaging, genome sequencing
and high-frequency finance.</p>
<p>This package aims to fill the gap by extending lasso model fitting to Big
Data in R. Version &gt;= 1.2-3 represents a major redesign where the source
code is converted into C++ (previously in C), and new feature screening
rules, as well as OpenMP parallel computing, are implemented. Some key
features of <code>biglasso</code> are summarized as below:</p><ol><li><p>it
utilizes memory-mapped files to store the massive data on the disk, only
loading data into memory when necessary during model fitting. Consequently,
it's able to seamlessly data-larger-than-RAM cases.</p></li>
<li><p>it is built upon
pathwise coordinate descent algorithm with warm start, active set cycling,
and feature screening strategies, which has been proven to be one of fastest
lasso solvers.</p></li>
<li><p>in incorporates our newly developed hybrid and adaptive
screening that outperform state-of-the-art screening rules such as
the sequential strong rule (SSR) and the sequential EDPP rule (SEDPP) with
additional 1.5x to 4x speedup.</p></li>
<li><p>the implementation is designed to be as
memory-efficient as possible by eliminating extra copies of the data created
by other R packages, making it at least 2x more memory-efficient than
<code>glmnet</code>.</p></li>
<li><p>the underlying computation is implemented in C++, and
parallel computing with OpenMP is also supported.</p></li>
</ol><p><strong>For more information:</strong></p><ul><li><p>Benchmarking results: <a href="https://github.com/pbreheny/biglasso" class="external-link">https://github.com/pbreheny/biglasso</a></p></li>
<li><p>Tutorial: <a href="https://pbreheny.github.io/biglasso/articles/biglasso.html">https://pbreheny.github.io/biglasso/articles/biglasso.html</a></p></li>
<li><p>Technical paper: <a href="https://arxiv.org/abs/1701.05936" class="external-link">https://arxiv.org/abs/1701.05936</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The input design matrix X must be a <code><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">bigmemory::big.matrix()</a></code> object.
This can be created by the function <code>as.big.matrix</code> in the R package
<a href="https://CRAN.R-project.org//package=bigmemory" class="external-link">bigmemory</a>.
If the data (design matrix) is very large (e.g. 10 GB) and stored in an external
file, which is often the case for big data, X can be created by calling the
function <code><a href="setupX.html">setupX()</a></code>.
<strong>In this case, there are several restrictions about the data file:</strong></p><ol><li><p>the data file must be a well-formated ASCII-file, with
each row corresponding to an observation and each column a variable;</p></li>
<li><p>the data file must contain only one single type. Current version only
supports <code>double</code> type;</p></li>
<li><p>the data file must contain only numeric
variables. If there are categorical variables, the user needs to create
dummy variables for each categorical varable (by adding additional columns).</p></li>
</ol><p>Future versions will try to address these restrictions.</p>
<p>Denote the number of observations and variables be, respectively, <code>n</code>
and <code>p</code>. It's worth noting that the package is more suitable for wide
data (ultrahigh-dimensional, <code>p &gt;&gt; n</code>) as compared to long data
(<code>n &gt;&gt; p</code>). This is because the model fitting algorithm takes advantage
of sparsity assumption of high-dimensional data. To just give the user some
ideas, below are some benchmarking results of the total computing time (in
seconds) for solving lasso-penalized linear regression along a sequence of
100 values of the tuning parameter. In all cases, assume 20 non-zero
coefficients equal +/- 2 in the true model. (Based on Version 1.2-3,
screening rule "SSR-BEDPP" is used)</p><ul><li><p>For wide data case (<code>p &gt; n</code>), <code>n = 1,000</code>:</p><table class="table table"><tr><td><code>p</code></td><td>1,000</td><td>10,000</td><td>100,000</td><td>1,000,000</td></tr><tr><td>Size of <code>X</code></td><td>9.5 MB</td><td>95 MB</td><td>950 MB</td><td>9.5 GB</td></tr><tr><td>Elapsed time (s)</td><td>0.11</td><td>0.83</td><td>8.47</td><td>85.50</td></tr></table><p>%</p></li>
<li><p>For long data case (<code>n &gt;&gt; p</code>), <code>p = 1,000</code>:
%</p><table class="table table"><tr><td>%<code>n</code></td><td>1,000</td><td>10,000</td><td>100,000</td><td>1,000,000</td></tr><tr><td>%Size of <code>X</code></td><td>9.5 MB</td><td>95 MB</td><td>950 MB</td><td>9.5 GB</td></tr><tr><td>%Elapsed time (s)</td><td>2.50</td><td>11.43</td><td>83.69</td><td>1090.62</td></tr></table></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Zeng Y and Breheny P. (2021) The biglasso Package: A Memory- and
Computation-Efficient Solver for Lasso Model Fitting with Big Data in R.
<em>R Journal</em>, <strong>12</strong>: 6-19.
<a href="https://doi.org/10.32614/RJ-2021-001" class="external-link">doi:10.32614/RJ-2021-001</a></p></li>
<li><p>Wang C and Breheny P. (2022) Adaptive hybrid screening for efficient
lasso optimization.
<em>Journal of Statistical Computation and Simulation</em>, <strong>92</strong>: 2233-2256.
<a href="https://doi.org/10.1080/00949655.2021.2025376" class="external-link">doi:10.1080/00949655.2021.2025376</a></p></li>
<li><p>Tibshirani, R., Bien, J., Friedman, J., Hastie, T., Simon, N., Taylor, J.,
and Tibshirani, R. J. (2012). Strong rules for discarding predictors in
lasso-type problems. <em>Journal of the Royal Statistical Society: Series
B (Statistical Methodology)</em>, <strong>74</strong>(2), 245-266.</p></li>
<li><p>Wang, J., Zhou, J., Wonka, P., and Ye, J. (2013). Lasso screening rules via dual
polytope projection. <em>In Advances in Neural Information Processing
Systems</em>, pp. 1070-1078.</p></li>
<li><p>Xiang, Z. J., and Ramadge, P. J. (2012).
Fast lasso screening tests based on correlations. <em>In Acoustics, Speech
and Signal Processing (ICASSP), 2012 IEEE International Conference on</em> (pp.
2137-2140). IEEE.</p></li>
<li><p>Wang, J., Zhou, J., Liu, J., Wonka, P., and Ye, J.
(2014). A safe screening rule for sparse logistic regression. <em>In
Advances in Neural Information Processing Systems</em>, pp. 1053-1061.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yaohui Zeng, Chuyi Wang, Tabitha Peter, and Patrick Breheny</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Example of reading data from external big data file, fit lasso model, </span></span></span>
<span class="r-in"><span><span class="co">## and run cross validation in parallel</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulated design matrix, 1000 observations, 500,000 variables, ~ 5GB</span></span></span>
<span class="r-in"><span><span class="co"># there are 10 true variables with non-zero coefficient 2.</span></span></span>
<span class="r-in"><span><span class="va">xfname</span> <span class="op">&lt;-</span> <span class="st">'x_e3_5e5.txt'</span> </span></span>
<span class="r-in"><span><span class="va">yfname</span> <span class="op">&lt;-</span> <span class="st">'y_e3_5e5.txt'</span> <span class="co"># response vector</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="setupX.html">setupX</a></span><span class="op">(</span><span class="va">xfname</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span> <span class="co"># create backing files (.bin, .desc)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="co"># ~ 7 minutes; this is just one-time operation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the big.matrix then can be retrieved by its descriptor file (.desc) in any new R session. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdesc</span> <span class="op">&lt;-</span> <span class="st">'x_e3_5e5.desc'</span> </span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">attach.big.matrix</span><span class="op">(</span><span class="va">xdesc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">yfname</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="biglasso.html">biglasso</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, screen <span class="op">=</span> <span class="st">'Hybrid'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time.fit</span><span class="op">)</span> <span class="co"># ~ 44 seconds for fitting a lasso model along the entire solution path</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cross validation in parallel</span></span></span>
<span class="r-in"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">1234</span></span></span>
<span class="r-in"><span><span class="va">time.cvfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">cvfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="cv.biglasso.html">cv.biglasso</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, screen <span class="op">=</span> <span class="st">'Hybrid'</span>, </span></span>
<span class="r-in"><span>                       seed <span class="op">=</span> <span class="va">seed</span>, ncores <span class="op">=</span> <span class="fl">4</span>, nfolds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time.cvfit</span><span class="op">)</span> <span class="co"># ~ 3 minutes for 10-fold cross validation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yaohui Zeng, Chuyi Wang, Tabitha Peter, Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated: July 28, 2025</p>
</div>

    </footer></div>





  </body></html>

