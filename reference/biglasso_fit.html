<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Direct interface to biglasso fitting, no preprocessing — biglasso_fit • biglasso</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Direct interface to biglasso fitting, no preprocessing — biglasso_fit"><meta property="og:description" content="This function is intended for users who know exactly what they're doing and
want complete control over the fitting process. It
does NOT add an intercept
does NOT standardize the design matrix
does NOT set up a path for lambda (the lasso tuning parameter)
all of the above are critical steps in data analysis. However, a direct API
has been provided for use in situations where the lasso fitting process is
an internal component of a more complicated algorithm and standardization
must be handled externally.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biglasso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/biglasso.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pbreheny/biglasso/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Direct interface to biglasso fitting, no preprocessing</h1>
    <small class="dont-index">Source: <a href="https://github.com/pbreheny/biglasso/blob/master/R/biglasso_fit.R" class="external-link"><code>R/biglasso_fit.R</code></a></small>
    <div class="hidden name"><code>biglasso_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is intended for users who know exactly what they're doing and
want complete control over the fitting process. It</p><ul><li><p>does NOT add an intercept</p></li>
<li><p>does NOT standardize the design matrix</p></li>
<li><p>does NOT set up a path for lambda (the lasso tuning parameter)
all of the above are critical steps in data analysis. However, a direct API
has been provided for use in situations where the lasso fitting process is
an internal component of a more complicated algorithm and standardization
must be handled externally.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">biglasso_fit</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">xtx</span>,</span>
<span>  penalty <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">gamma</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>  penalty.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return.time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The design matrix, without an intercept. It must be a
double type <code><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">bigmemory::big.matrix()</a></code> object.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response vector</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Residuals (length n vector) corresponding to <code>init</code>.
WARNING: If you supply an incorrect value of <code>r</code>, the
solution will be incorrect.</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>Initial values for beta.  Default: zero (length p vector)</p></dd>


<dt id="arg-xtx">xtx<a class="anchor" aria-label="anchor" href="#arg-xtx"></a></dt>
<dd><p>X scales: the jth element should equal <code>crossprod(X[,j])/n</code>.
In particular, if X is standardized, one should pass
<code>xtx = rep(1, p)</code>.  WARNING: If you supply an incorrect value of
<code>xtx</code>, the solution will be incorrect. (length p vector)</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>String specifying which penalty to use. Default is 'lasso',
Other options are 'SCAD' and 'MCP' (the latter are non-convex)</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A single value for the lasso tuning parameter.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The elastic-net mixing parameter that controls the relative
contribution from the lasso (l1) and the ridge (l2) penalty.
The penalty is defined as:
$$ \alpha||\beta||_1 + (1-\alpha)/2||\beta||_2^2.$$
<code>alpha=1</code> is the lasso penalty, <code>alpha=0</code> the ridge penalty,
<code>alpha</code> in between 0 and 1 is the elastic-net ("enet") penalty.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Tuning parameter value for nonconvex penalty. Defaults are
3.7 for <code>penalty = 'SCAD'</code> and 3 for <code>penalty = 'MCP'</code></p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>The number of OpenMP threads used for parallel computing.</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum number of iterations.  Default is 1000.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Convergence threshold for inner coordinate descent. The
algorithm iterates until the maximum change in the objective
after any coefficient update is less than <code>eps</code> times
the null deviance. Default value is <code>1e-7</code>.</p></dd>


<dt id="arg-dfmax">dfmax<a class="anchor" aria-label="anchor" href="#arg-dfmax"></a></dt>
<dd><p>Upper bound for the number of nonzero coefficients. Default is
no upper bound.  However, for large data sets,
computational burden may be heavy for models with a large
number of nonzero coefficients.</p></dd>


<dt id="arg-penalty-factor">penalty.factor<a class="anchor" aria-label="anchor" href="#arg-penalty-factor"></a></dt>
<dd><p>A multiplicative factor for the penalty applied to
each coefficient. If supplied, <code>penalty.factor</code> must be a numeric
vector of length equal to the number of columns of <code>X</code>.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>Return warning messages for failures to converge and model
saturation?  Default is TRUE.</p></dd>


<dt id="arg-output-time">output.time<a class="anchor" aria-label="anchor" href="#arg-output-time"></a></dt>
<dd><p>Whether to print out the start and end time of the model
fitting. Default is FALSE.</p></dd>


<dt id="arg-return-time">return.time<a class="anchor" aria-label="anchor" href="#arg-return-time"></a></dt>
<dd><p>Whether to return the computing time of the model
fitting. Default is TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object with S3 class <code>"biglasso"</code> with following variables.</p>
<dl><dt>beta</dt>
<dd><p>The vector of estimated coefficients</p></dd>

<dt>iter</dt>
<dd><p>A vector of length <code>nlambda</code> containing the number of
iterations until convergence</p></dd>

<dt>resid</dt>
<dd><p>Vector of residuals calculated from estimated coefficients.</p></dd>

<dt>lambda</dt>
<dd><p>The sequence of regularization parameter values in the path.</p></dd>

<dt>alpha</dt>
<dd><p>Same as in <code><a href="biglasso.html">biglasso()</a></code></p></dd>

<dt>loss</dt>
<dd><p>A vector containing either the residual sum of squares of the fitted model at each value of lambda.</p></dd>

<dt>penalty.factor</dt>
<dd><p>Same as in <code><a href="biglasso.html">biglasso()</a></code>.</p></dd>

<dt>n</dt>
<dd><p>The number of observations used in the model fitting.</p></dd>

<dt>y</dt>
<dd><p>The response vector used in the model fitting.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Note:</p><ul><li><p>Hybrid safe-strong rules are turned off for <code>biglasso_fit()</code>, as these rely
on standardization</p></li>
<li><p>Currently, the function only works with linear regression
(<code>family = 'gaussian'</code>).</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Tabitha Peter and Patrick Breheny</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Prostate</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">2</span>, <span class="va">crossprod</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">X.bm</span> <span class="op">&lt;-</span> <span class="fu">as.big.matrix</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">biglasso_fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">X.bm</span>, y <span class="op">=</span> <span class="va">y</span>, r<span class="op">=</span><span class="va">y</span>, init <span class="op">=</span> <span class="va">init</span>, xtx <span class="op">=</span> <span class="va">xtx</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fl">0.1</span>, penalty.factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, max.iter <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    lcavol      lweight          age         lbph          svi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.725303940  0.577848489  0.043409725 -0.005572137  0.076326241  0.000000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lcp      gleason        pgg45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000000  0.000000000  0.006712771 </span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">biglasso_fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">X.bm</span>, y <span class="op">=</span> <span class="va">y</span>, r<span class="op">=</span><span class="va">y</span>, init <span class="op">=</span> <span class="va">init</span>, xtx <span class="op">=</span> <span class="va">xtx</span>, penalty<span class="op">=</span><span class="st">'MCP'</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fl">0.1</span>, penalty.factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, max.iter <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    lcavol      lweight          age         lbph          svi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.268444208  0.677388754  0.000000000 -0.013317940  0.143711214  0.000000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lcp      gleason        pgg45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000000  0.000000000  0.005398707 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yaohui Zeng, Chuyi Wang, Tabitha Peter, Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

