<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Direct interface to biglasso fitting, no preprocessing, path version — biglasso_path • biglasso</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Direct interface to biglasso fitting, no preprocessing, path version — biglasso_path"><meta name="description" content="This function is intended for users who know exactly what they're doing and
want complete control over the fitting process. It
does NOT add an intercept
does NOT standardize the design matrix
both of the above are critical steps in data analysis. However, a direct API
has been provided for use in situations where the lasso fitting process is
an internal component of a more complicated algorithm and standardization
must be handled externally.

"><meta property="og:description" content="This function is intended for users who know exactly what they're doing and
want complete control over the fitting process. It
does NOT add an intercept
does NOT standardize the design matrix
both of the above are critical steps in data analysis. However, a direct API
has been provided for use in situations where the lasso fitting process is
an internal component of a more complicated algorithm and standardization
must be handled externally.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biglasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/biglasso.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/biglasso/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Direct interface to biglasso fitting, no preprocessing, path version</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/biglasso/blob/master/R/biglasso_path.R" class="external-link"><code>R/biglasso_path.R</code></a></small>
      <div class="d-none name"><code>biglasso_path.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is intended for users who know exactly what they're doing and
want complete control over the fitting process. It</p><ul><li><p>does NOT add an intercept</p></li>
<li><p>does NOT standardize the design matrix
both of the above are critical steps in data analysis. However, a direct API
has been provided for use in situations where the lasso fitting process is
an internal component of a more complicated algorithm and standardization
must be handled externally.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">biglasso_path</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">xtx</span>,</span>
<span>  penalty <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">gamma</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>  penalty.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return.time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The design matrix, without an intercept. It must be a
double type <code><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">bigmemory::big.matrix()</a></code> object.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response vector</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Residuals (length n vector) corresponding to <code>init</code>.
WARNING: If you supply an incorrect value of <code>r</code>, the
solution will be incorrect.</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>Initial values for beta.  Default: zero (length p vector)</p></dd>


<dt id="arg-xtx">xtx<a class="anchor" aria-label="anchor" href="#arg-xtx"></a></dt>
<dd><p>X scales: the jth element should equal <code>crossprod(X[,j])/n</code>.
In particular, if X is standardized, one should pass
<code>xtx = rep(1, p)</code>. WARNING: If you supply an incorrect value of
<code>xtx</code>, the solution will be incorrect. (length p vector)</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>String specifying which penalty to use. Default is 'lasso',
Other options are 'SCAD' and 'MCP' (the latter are non-convex)</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>A vector of numeric values the lasso tuning parameter.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The elastic-net mixing parameter that controls the relative
contribution from the lasso (l1) and the ridge (l2) penalty.
The penalty is defined as:
$$ \alpha||\beta||_1 + (1-\alpha)/2||\beta||_2^2.$$
<code>alpha=1</code> is the lasso penalty, <code>alpha=0</code> the ridge penalty,
<code>alpha</code> in between 0 and 1 is the elastic-net ("enet") penalty.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Tuning parameter value for nonconvex penalty. Defaults are
3.7 for <code>penalty = 'SCAD'</code> and 3 for <code>penalty = 'MCP'</code></p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>The number of OpenMP threads used for parallel computing.</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum number of iterations.  Default is 1000.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Convergence threshold for inner coordinate descent. The
algorithm iterates until the maximum change in the objective
after any coefficient update is less than <code>eps</code> times
the null deviance. Default value is <code>1e-7</code>.</p></dd>


<dt id="arg-dfmax">dfmax<a class="anchor" aria-label="anchor" href="#arg-dfmax"></a></dt>
<dd><p>Upper bound for the number of nonzero coefficients. Default is
no upper bound.  However, for large data sets,
computational burden may be heavy for models with a large
number of nonzero coefficients.</p></dd>


<dt id="arg-penalty-factor">penalty.factor<a class="anchor" aria-label="anchor" href="#arg-penalty-factor"></a></dt>
<dd><p>A multiplicative factor for the penalty applied to
each coefficient. If supplied, <code>penalty.factor</code> must be a numeric
vector of length equal to the number of columns of <code>X</code>.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>Return warning messages for failures to converge and model
saturation?  Default is TRUE.</p></dd>


<dt id="arg-output-time">output.time<a class="anchor" aria-label="anchor" href="#arg-output-time"></a></dt>
<dd><p>Whether to print out the start and end time of the model
fitting. Default is FALSE.</p></dd>


<dt id="arg-return-time">return.time<a class="anchor" aria-label="anchor" href="#arg-return-time"></a></dt>
<dd><p>Whether to return the computing time of the model
fitting. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object with S3 class <code>"biglasso"</code> with following variables.</p>
<dl><dt>beta</dt>
<dd><p>A sparse matrix where rows are estimates a given coefficient across all values of lambda</p></dd>

<dt>iter</dt>
<dd><p>A vector of length <code>nlambda</code> containing the number of
iterations until convergence</p></dd>

<dt>resid</dt>
<dd><p>Vector of residuals calculated from estimated coefficients.</p></dd>

<dt>lambda</dt>
<dd><p>The sequence of regularization parameter values in the path.</p></dd>

<dt>alpha</dt>
<dd><p>Same as in <code><a href="biglasso.html">biglasso()</a></code></p></dd>

<dt>loss</dt>
<dd><p>A vector containing either the residual sum of squares of the fitted model at each value of lambda.</p></dd>

<dt>penalty.factor</dt>
<dd><p>Same as in <code><a href="biglasso.html">biglasso()</a></code>.</p></dd>

<dt>n</dt>
<dd><p>The number of observations used in the model fitting.</p></dd>

<dt>y</dt>
<dd><p>The response vector used in the model fitting.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>biglasso_path()</code> works identically to <code><a href="biglasso_fit.html">biglasso_fit()</a></code> except it offers the
additional option of fitting models across a path of tuning parameter values.</p>
<p>Note:</p><ul><li><p>Hybrid safe-strong rules are turned off for <code><a href="biglasso_fit.html">biglasso_fit()</a></code>, as these rely
on standardization</p></li>
<li><p>Currently, the function only works with linear regression
(<code>family = 'gaussian'</code>).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tabitha Peter and Patrick Breheny</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Prostate</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">2</span>, <span class="va">crossprod</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">X.bm</span> <span class="op">&lt;-</span> <span class="fu">as.big.matrix</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">biglasso_path</span><span class="op">(</span>X <span class="op">=</span> <span class="va">X.bm</span>, y <span class="op">=</span> <span class="va">y</span>, r <span class="op">=</span> <span class="va">y</span>, init <span class="op">=</span> <span class="va">init</span>, xtx <span class="op">=</span> <span class="va">xtx</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  penalty.factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, max.iter<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1.86789798  1.726547654  1.105241004  0.62236552  0.237779016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol  0.22521668  0.577920344  0.559394365  0.55854063  0.563967682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight .           0.042348062  0.334244868  0.55897485  0.615294573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age     .          -0.005532399 -0.012370678 -0.01887351 -0.020994791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph    .           0.076396177  0.083246962  0.09416931  0.096496944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi     .           .            0.255311017  0.63017098  0.748190547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp     .           .            .           -0.06349802 -0.101736983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gleason .           .            .            .           0.042445101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pgg45   0.01256831  0.006710624  0.005389947  0.00498825  0.004541638</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">biglasso_path</span><span class="op">(</span>X <span class="op">=</span> <span class="va">X.bm</span>, y <span class="op">=</span> <span class="va">y</span>, r <span class="op">=</span> <span class="va">y</span>, init <span class="op">=</span> <span class="va">init</span>, xtx <span class="op">=</span> <span class="va">xtx</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span>, penalty<span class="op">=</span><span class="st">'MCP'</span>,</span></span>
<span class="r-in"><span>  penalty.factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, max.iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1.648298073 -0.115420660  0.494158018  0.187554573  0.187527451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol   0.667634641  0.600386232  0.569551761  0.564445466  0.564444994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight  .            0.753123645  0.613981343  0.621790535  0.621791579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age     -0.003182706 -0.017330406 -0.020888578 -0.021242328 -0.021242354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph     .            0.007112865  0.097369534  0.096738824  0.096738703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi      .            .            0.752459039  0.761518580  0.761519278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp      .            .           -0.104951529 -0.106015242 -0.106015402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gleason  .            .            .            0.048346251  0.048350230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pgg45    0.005416757  0.006411446  0.005322958  0.004471521  0.004471458</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yaohui Zeng, Chuyi Wang, Tabitha Peter, Patrick Breheny.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

